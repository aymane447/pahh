{% extends 'base.html.twig' %}

{% block title %}{{ form.vars.value.id ? 'Modifier' : 'Nouveau' }} Ticket - TicketFlow{% endblock %}

{% block body %}
<div class="container">
    <div style="max-width: 700px; margin: 0 auto;">
        <div style="margin-bottom: 30px;">
            <a href="{{ path('app_tick') }}" style="color: var(--text-muted); text-decoration: none; font-size: 0.9rem; display: flex; align-items: center; gap: 8px;">
                ← Retour à la liste
            </a>
            <h1 style="font-size: 2rem; font-weight: 700; margin-top: 15px;">
                {{ form.vars.value.id ? 'Modifier le Ticket #' ~ form.vars.value.id : 'Ouvrir un nouveau Ticket' }}
            </h1>
            <p style="color: var(--text-muted);">Remplissez les détails ci-dessous.</p>
        </div>

        <div class="card">
            {{ form_start(form) }}
                <style>
                    .form-group { margin-bottom: 20px; }
                    .form-group label { display: block; margin-bottom: 8px; font-weight: 500; font-size: 0.9rem; }
                    .form-input { 
                        width: 100%; padding: 12px; background: rgba(15, 23, 42, 0.6); 
                        border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; 
                        color: white; font-size: 1rem; transition: border-color 0.3s;
                    }
                    .form-input:focus { outline: none; border-color: var(--primary); }
                    .btn-submit {
                        width: 100%; padding: 14px; background: var(--primary); 
                        border: none; border-radius: 12px; color: white; 
                        font-weight: 600; cursor: pointer; transition: transform 0.2s;
                    }
                    .btn-submit:hover { transform: translateY(-2px); background: var(--secondary); }
                    
                    /* Customizing form widgets */
                    input, textarea, select { @extend .form-input; width:100%; padding: 12px; background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; color: white; margin-bottom: 10px;}
                </style>

                <div class="form-group">
                    <label>Sujet du Ticket</label>
                    {{ form_widget(form.titre, {'attr': {'placeholder': 'Ex: Problème d\'accès au compte'}}) }}
                </div>

                <div class="form-group">
                    <label>Priorité</label>
                    {{ form_widget(form.priorite) }}
                </div>

                <div class="form-group">
                    <label>Catégorie</label>
                    {{ form_widget(form.id_categorie) }}
                </div>

                <div class="form-group">
                    <label>Description détaillée</label>
                    {{ form_widget(form.description, {'attr': {'rows': 6, 'placeholder': 'Décrivez votre problème ici...'}}) }}
                </div>

                {# Only show admin/agent fields if they exist in the form (form_widget handles this but we can be explicit) #}
                {% if form.statut is defined %}
                    <div class="form-group">
                        <label>Statut</label>
                        {{ form_widget(form.statut) }}
                    </div>
                {% endif %}

                <button type="submit" class="btn-submit">
                    {{ form.vars.value.id ? 'Mettre à jour le ticket' : 'Envoyer le ticket' }}
                </button>
            {{ form_end(form) }}
        </div>
    </div>
</div>
{% endblock %}
